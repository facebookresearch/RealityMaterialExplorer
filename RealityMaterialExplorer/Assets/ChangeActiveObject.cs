/*
Copyright (c) Meta Platforms, Inc. and affiliates.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.UI;

public class ChangeActiveObject : MonoBehaviour
{
	public Material[] BRDFMaterials;
	public Material[] MERLMaterials;
	public int mi;
	private int countdown = 0;
	public int activeBRDFnumber;
	

	
	public GameObject[] objects;
	public int numobj;
	private GameObject activeobj;
    private int activeindex;
	
	public Text prevtext;
	public Text curtext;
	public Text nexttext;
	
	public Slider drslider;
	public Slider dgslider;
	public Slider dbslider;
	public Slider srslider;
	public Slider sgslider;
	public Slider sbslider;
	public Slider aslider;
	public Slider etaslider;
	
	public ButtonGroupSelect MERLButtons;
	public ButtonGroupSelect ModelsButtons;
	public ButtonGroupSelect MSButtons;
	public ButtonGroupSelect GeoButtons;
	public ButtonGroupSelect autoFitButtons;
	
	public Text MSText;

	public bool autoFit;
	
	public ActiveUntilChange ApplyFitButton;
	
	/*For Plots*/
	
	public Material activeMaterialForPlot;
	
	
	
	
private double[,] GGXfits = new double[,] {{0.040399,0.031778,0.022585,0.440321,0.34218,0.25686,0.105501,0.369341},
{0.305795,0.281854,0.248346,0.261003,0.275987,0.332124,0.011976,0.144174},
{0.013071,0.013788,0.015482,0.287641,0.260744,0.272878,0.016002,0.992647},
{0.055498,0.06278,0.05393,0.137886,0.125787,0.128629,0.014803,0.148607},
{0.120058,0.04342,0.016832,0.999998,0.999998,0.999998,0.843252,0.723611},
{0.013105,0.007234,0.006591,0.228304,0.190652,0.194223,0.641393,0.070131},
{0.000343,0.000177,0.00024,0.162151,0.151783,0.159109,0.011022,0.140161},
{0.009889,0.008426,0.007682,0.390253,0.38614,0.38154,0.268423,0.145372},
{0.001424,0.001028,0.000763,0.103895,0.104883,0.108293,0.025387,0.362169},
{0.001196,0.000869,0.000837,0.509233,0.50979,0.514978,0.425489,0.132036},
{0.012659,0.036241,0.103983,0.175848,0.156414,0.15447,0.018743,0.143648},
{0.000455,0.001194,0.025411,0.636018,0.698114,0.999998,0.748144,0.189066},
{0.000002,0.000002,0.000002,0.153482,0.135751,0.327303,0.221655,0.995699},
{0.004076,0.005289,0.011972,0.168184,0.244768,0.45067,0.023985,0.581697},
{0.03738,0.075864,0.156053,0.55932,0.554895,0.541864,0.250074,0.079633},
{0.019037,0.016794,0.011606,0.255132,0.168245,0.094652,0.011736,0.969362},
{0.038452,0.015638,0.008295,0.294069,0.289972,0.286539,0.16728,0.149599},
{0.002201,0.001661,0.001834,0.3043,0.287065,0.284334,0.006864,0.998994},
{0.004156,0.003263,0.003053,0.257227,0.228311,0.27223,0.009786,0.887178},
{0.083223,0.025098,0.010006,0.441797,0.404077,0.393663,0.238966,0.132974},
{0.000879,0.001062,0.001527,0.195627,0.241842,0.244554,0.05204,0.323412},
{0.004083,0.004938,0.006509,0.30649,0.239053,0.24753,0.07156,0.495752},
{0.001648,0.001379,0.000864,0.206216,0.215864,0.186243,0.057823,0.331033},
{0.002203,0.007988,0.03569,0.435297,0.368658,0.395349,0.342466,0.147543},
{0.250002,0.030965,0.007677,0.606844,0.531396,0.577005,0.405271,0.094339},
{0.019392,0.007894,0.006023,0.510675,0.475366,0.469583,0.285208,0.079561},
{0.30871,0.296472,0.258997,0.396143,0.363123,0.340112,0.099336,0.075708},
{0.048364,0.03388,0.018816,0.397035,0.393938,0.395715,0.141859,0.120821},
{0.000002,0.000002,0.000002,0.561151,0.363336,0.122369,0.23863,0.998994},
{0.029306,0.022035,0.01267,0.341821,0.300428,0.249048,0.150411,0.998994},
{0.044214,0.027979,0.012842,0.401483,0.311979,0.181802,0.036867,0.861726},
{0.134592,0.067682,0.021738,0.428613,0.348444,0.198862,0.245741,0.612695},
{0.100179,0.100366,0.093553,0.170866,0.173689,0.175012,0.042202,0.167627},
{0.006281,0.006555,0.00799,0.260309,0.249384,0.235284,0.032738,0.998994},
{0.016683,0.0739,0.039796,0.263155,0.266885,0.240388,0.012502,0.136438},
{0.039325,0.034351,0.043737,0.743433,0.999986,0.999998,0.602026,0.10219},
{0.052038,0.085683,0.035028,0.668726,0.750497,0.455316,0.670408,0.277063},
{0.000002,0.009943,0.016897,0.149988,0.385431,0.406396,0.204374,0.442743},
{0.002054,0.007074,0.003168,0.162695,0.29833,0.196306,0.03145,0.307062},
{0.013509,0.07953,0.086984,0.148161,0.123079,0.124279,0.010813,0.151582},
{0.005792,0.005678,0.005991,0.205341,0.207048,0.212522,0.020643,0.345064},
{0.052984,0.018869,0.007228,0.459596,0.439424,0.417162,0.2003,0.122438},
{0.034807,0.006433,0.002683,0.999998,0.854852,0.724268,0.879232,0.126459},
{0.413431,0.039709,0.004743,0.555635,0.489385,0.557565,0.34223,0.110742},
{0.189241,0.033823,0.029947,0.147073,0.144725,0.150705,0.012129,0.165422},
{0.096521,0.035852,0.012292,0.795984,0.792505,0.769556,0.206442,0.08053},
{0.244814,0.207368,0.169748,0.254572,0.254846,0.242639,0.194227,0.195795},
{0.002142,0.001543,0.001394,0.471132,0.428621,0.388498,0.052768,0.998994},
{0.248773,0.246271,0.220544,0.281122,0.321878,0.285196,0.041862,0.04371},
{0.410059,0.135492,0.003948,0.601144,0.533395,0.521425,0.369268,0.105589},
{0.158891,0.141588,0.127443,0.393091,0.337854,0.225427,0.26621,0.887613},
{0.131441,0.097658,0.081598,0.212061,0.210291,0.204065,0.211111,0.273157},
{0.163629,0.104417,0.112688,0.999998,0.999998,0.999998,0.818243,0.60029},
{0.195688,0.016534,0.01021,0.999998,0.900842,0.83613,0.679533,0.341272},
{0.219873,0.132349,0.113763,0.999998,0.999998,0.999998,0.692602,0.388712},
{0.194955,0.121378,0.096658,0.179739,0.180969,0.179996,0.030674,0.163995},
{0.38495,0.09012,0.064439,0.999998,0.704736,0.725122,0.445333,0.070444},
{0.06817,0.07438,0.068948,0.999998,0.999998,0.999998,0.777097,0.998994},
{0.048509,0.000002,0.000002,0.999998,0.967935,0.764597,0.899236,0.230798},
{0.28634,0.251657,0.213991,0.340936,0.32995,0.304865,0.26174,0.10676},
{0.269846,0.030456,0.028596,0.355676,0.341638,0.363985,0.082992,0.119302},
{0.031675,0.034967,0.038686,0.309633,0.308893,0.311334,0.068367,0.119646},
{0.177209,0.017652,0.001928,0.487817,0.163675,0.138452,0.498647,0.248247},
{0.130563,0.006685,0.000002,0.999998,0.498857,0.373392,0.778326,0.169199},
{0.024866,0.002588,0.000681,0.447469,0.116823,0.085184,0.023008,0.502901},
{0.161142,0.023973,0.008312,0.184961,0.205118,0.243421,0.030483,0.15883},
{0.27527,0.047052,0.012365,0.516718,0.468546,0.463358,0.26602,0.123125},
{0.239954,0.035715,0.014963,0.237104,0.236536,0.250429,0.012073,0.103448},
{0.006393,0.006244,0.006424,0.228798,0.214525,0.224249,0.016784,0.20569},
{0.000002,0.000002,0.000002,0.570581,0.567133,0.562708,0.21327,0.998994},
{0.000002,0.000002,0.001398,0.999994,0.963907,0.899316,0.340002,0.770235},
{0.138254,0.105531,0.08822,0.372156,0.387354,0.392435,0.246069,0.998994},
{0.00588,0.002466,0.00066,0.338724,0.336053,0.334535,0.26515,0.158029},
{0.001993,0.002046,0.002262,0.152156,0.146104,0.166444,0.01145,0.165872},
{0.004564,0.012678,0.030405,0.166248,0.143865,0.146549,0.011003,0.173608},
{0.006839,0.024614,0.021505,0.180338,0.155433,0.162588,0.010525,0.160814},
{0.149316,0.024976,0.007263,0.163433,0.145193,0.156471,0.010383,0.169313},
{0.318475,0.051561,0.005563,0.119356,0.114515,0.135538,0.009266,0.175523},
{0.294656,0.03383,0.00819,0.160316,0.141473,0.1639,0.011028,0.169817},
{0.067541,0.016622,0.019258,0.14821,0.13651,0.147045,0.009647,0.176271},
{0.280511,0.22542,0.124933,0.027208,0.034212,0.030698,0.004713,0.998994},
{0.297708,0.130212,0.012884,0.157911,0.136283,0.148111,0.010582,0.171266},
{0.004449,0.003831,0.003744,0.233694,0.201418,0.20228,0.008466,0.998994},
{0.005827,0.005304,0.0058,0.245798,0.226793,0.223138,0.006511,0.998994},
{0.320551,0.312357,0.301492,0.425928,0.429529,0.436578,0.195364,0.118433},
{0.003057,0.002523,0.002468,0.21314,0.196111,0.232587,0.007297,0.998994},
{0.027078,0.020334,0.011423,0.353517,0.31698,0.265577,0.14995,0.998994},
{0.034006,0.03631,0.038622,0.362337,0.34979,0.342083,0.169977,0.998994},
{0.049463,0.013986,0.023401,0.084192,0.065317,0.100511,0.111843,0.998972},
{0.240488,0.054802,0.118349,0.337885,0.316949,0.337457,0.292722,0.146906},
{0.311914,0.295438,0.256937,0.13166,0.125539,0.126474,0.013431,0.145967},
{0.311487,0.263361,0.173059,0.286859,0.287073,0.277979,0.153944,0.140787},
{0.237917,0.14203,0.072054,0.999998,0.999998,0.999998,0.82588,0.4228},
{0.004007,0.000002,0.011884,0.999998,0.999998,0.999998,0.926695,0.499399},
{0.227007,0.212701,0.188425,0.145116,0.14277,0.131116,0.012636,0.211969},
{0.305688,0.298135,0.289896,0.369241,0.33465,0.335191,0.034199,0.084558},
{0.28404,0.111192,0.018617,0.350114,0.360986,0.386812,0.053358,0.101831},
{0.298639,0.193414,0.02474,0.454034,0.458704,0.431299,0.3402,0.111932},
{0.289575,0.208833,0.099603,0.119592,0.114656,0.118326,0.020107,0.226717},
{0.24933,0.21174,0.036653,0.828607,0.782495,0.607233,0.357595,0.080362}
};

private double[,] CTfits = new double[,] {{0.049402,0.038843,0.028009,0.306039,0.238313,0.177545,0.145168,0.428613},
{0.30871,0.284692,0.25123,0.251497,0.274591,0.323206,0.013632,0.130334},
{0.020609,0.0216,0.024118,0.222356,0.189611,0.196798,0.015081,0.939424},
{0.056825,0.06418,0.055406,0.096185,0.088985,0.088192,0.015386,0.163606},
{0.253946,0.178049,0.154001,0.999998,0.967615,0.854517,0.895681,0.098871},
{0.014005,0.008062,0.007455,0.086347,0.070448,0.070047,0.603708,0.076501},
{0.00057,0.000373,0.000461,0.132963,0.12714,0.132555,0.013817,0.137308},
{0.014322,0.012855,0.012117,0.255807,0.251093,0.245874,0.285726,0.152795},
{0.002565,0.002199,0.001978,0.088914,0.087114,0.086069,0.028578,0.361322},
{0.008451,0.008134,0.00818,0.256448,0.256372,0.258783,0.395208,0.127992},
{0.014227,0.038339,0.106973,0.1229,0.108743,0.113002,0.015306,0.150209},
{0.018615,0.021072,0.053156,0.528482,0.583704,0.911432,0.769483,0.070253},
{0.008737,0.006799,0.01864,0.120264,0.110513,0.255304,0.26267,0.998994},
{0.008264,0.011469,0.02392,0.147768,0.21216,0.383035,0.025976,0.496828},
{0.039867,0.078252,0.158258,0.298502,0.299478,0.294458,0.261732,0.101022},
{0.0263,0.022554,0.015176,0.184049,0.119066,0.06767,0.011722,0.998994},
{0.042322,0.01925,0.011644,0.17045,0.167993,0.169763,0.168752,0.18728},
{0.003419,0.002756,0.002985,0.287374,0.282274,0.276006,0.009903,0.98224},
{0.006937,0.005991,0.006082,0.24864,0.209726,0.256639,0.011366,0.700655},
{0.089532,0.029893,0.014446,0.258569,0.245554,0.23974,0.233198,0.1466},
{0.003595,0.004861,0.005624,0.193231,0.218866,0.220682,0.05714,0.265649},
{0.012231,0.011179,0.013086,0.234018,0.185808,0.194231,0.084224,0.526456},
{0.005464,0.005304,0.003923,0.196268,0.200502,0.184396,0.060632,0.261713},
{0.007919,0.012954,0.041177,0.246973,0.20733,0.221002,0.348409,0.157724},
{0.255151,0.034761,0.012054,0.290948,0.257478,0.267267,0.38989,0.105981},
{0.021562,0.009986,0.008012,0.308099,0.282869,0.281862,0.318884,0.088892},
{0.308649,0.295618,0.258066,0.242517,0.235315,0.231775,0.133901,0.115701},
{0.051569,0.037084,0.02189,0.300378,0.294855,0.293954,0.160818,0.126184},
{0.058252,0.033228,0.006067,0.368494,0.253778,0.099634,0.248235,0.998994},
{0.047853,0.038293,0.026071,0.273241,0.239179,0.196958,0.187561,0.998994},
{0.064462,0.043008,0.021112,0.320013,0.250101,0.147745,0.042896,0.778535},
{0.162836,0.090479,0.034616,0.234628,0.190607,0.108469,0.249403,0.820734},
{0.104143,0.104425,0.09762,0.144891,0.142122,0.137788,0.038938,0.151941},
{0.016534,0.017053,0.019067,0.215067,0.205164,0.191919,0.03668,0.998994},
{0.018167,0.076059,0.041711,0.238439,0.247629,0.212671,0.013614,0.128206},
{0.047666,0.044967,0.053304,0.620966,0.884729,0.999998,0.630003,0.054765},
{0.086305,0.124673,0.058347,0.221399,0.242014,0.151086,0.53034,0.187753},
{0.004606,0.02495,0.032976,0.110345,0.259058,0.272485,0.225935,0.489465},
{0.00509,0.014581,0.007364,0.134229,0.218343,0.153879,0.026336,0.274957},
{0.014322,0.080919,0.088487,0.106786,0.097881,0.1005,0.012985,0.152406},
{0.009302,0.009409,0.009912,0.149999,0.150079,0.147956,0.015501,0.329073},
{0.057397,0.022791,0.010608,0.301614,0.290674,0.281396,0.217245,0.133127},
{0.049734,0.019682,0.013876,0.999998,0.722475,0.613626,0.748297,0.036752},
{0.418047,0.044004,0.009546,0.305322,0.271528,0.307581,0.351667,0.121198},
{0.191553,0.03502,0.031236,0.118314,0.110529,0.109335,0.01466,0.169466},
{0.099619,0.038858,0.015112,0.467676,0.441675,0.411798,0.231466,0.106973},
{0.248811,0.211458,0.17386,0.162393,0.162119,0.152521,0.20429,0.230981},
{0.013864,0.012079,0.011133,0.409944,0.368799,0.32998,0.064649,0.998994},
{0.249963,0.247888,0.221826,0.220575,0.24502,0.220483,0.038915,0.042307},
{0.412988,0.139482,0.007307,0.295847,0.254099,0.253175,0.378202,0.132249},
{0.197717,0.174768,0.149652,0.232568,0.200769,0.134058,0.256414,0.998994},
{0.136041,0.101038,0.084558,0.102533,0.102808,0.100732,0.220602,0.474695},
{0.282083,0.222864,0.23118,0.999998,0.999998,0.999998,0.825125,0.085985},
{0.251329,0.075281,0.064851,0.744897,0.485956,0.448633,0.622488,0.14982},
{0.292673,0.205263,0.186388,0.999998,0.999998,0.999963,0.717855,0.112085},
{0.205324,0.129083,0.10359,0.100483,0.102369,0.101114,0.016939,0.178125},
{0.392397,0.093958,0.067926,0.417566,0.302515,0.31875,0.439291,0.081537},
{0.239099,0.244714,0.241571,0.999998,0.999998,0.941064,0.747183,0.14409},
{0.071371,0.027399,0.018648,0.999998,0.70968,0.673883,0.999998,0.098688},
{0.288812,0.254068,0.216287,0.178918,0.172327,0.157022,0.267278,0.13952},
{0.279993,0.034174,0.033273,0.224344,0.22149,0.219049,0.081335,0.149408},
{0.034891,0.038354,0.042245,0.255304,0.249368,0.246591,0.066797,0.112497},
{0.194437,0.023409,0.007782,0.200494,0.066713,0.048601,0.435491,0.245378},
{0.144899,0.017511,0.007566,0.999998,0.32184,0.262094,0.795477,0.084894},
{0.041223,0.005487,0.002287,0.303243,0.089273,0.067949,0.022121,0.522798},
{0.16472,0.026315,0.010412,0.196817,0.203922,0.215055,0.031343,0.123941},
{0.281572,0.05187,0.016695,0.293886,0.278864,0.283777,0.274191,0.135782},
{0.242609,0.03692,0.016023,0.23023,0.229044,0.236856,0.014854,0.094987},
{0.008012,0.00786,0.008142,0.170574,0.163313,0.173246,0.015205,0.210512},
{0.050806,0.053262,0.055811,0.404474,0.395349,0.385828,0.222982,0.998994},
{0.130029,0.131555,0.127954,0.406885,0.369287,0.332666,0.273802,0.998994},
{0.176553,0.144724,0.1271,0.244684,0.256036,0.262048,0.240568,0.998994},
{0.010116,0.006597,0.00465,0.206697,0.2063,0.207723,0.280981,0.17515},
{0.002454,0.002542,0.00284,0.122879,0.117908,0.13336,0.014272,0.158022},
{0.005125,0.01341,0.031408,0.139223,0.123237,0.126686,0.015602,0.170229},
{0.00744,0.025514,0.022417,0.134302,0.125002,0.127229,0.014322,0.174104},
{0.151048,0.025804,0.007822,0.147918,0.132362,0.133518,0.01552,0.159273},
{0.320528,0.052431,0.006116,0.109748,0.100912,0.10341,0.0126,0.155626},
{0.298273,0.034837,0.008901,0.130203,0.11689,0.125457,0.014635,0.176759},
{0.068552,0.017229,0.019933,0.138849,0.125684,0.135717,0.014948,0.155916},
{0.27186,0.216974,0.120435,0.092226,0.087965,0.082195,0.01028,0.276552},
{0.300844,0.131921,0.013727,0.14007,0.122293,0.123991,0.015049,0.164339},
{0.006723,0.005884,0.005815,0.210069,0.180704,0.180719,0.010708,0.998994},
{0.007234,0.006593,0.007135,0.304109,0.258928,0.252534,0.009992,0.624483},
{0.324739,0.316614,0.305818,0.244379,0.247156,0.251031,0.19396,0.145563},
{0.004205,0.003595,0.003641,0.199426,0.182413,0.222986,0.011129,0.84659},
{0.048196,0.03924,0.027032,0.280622,0.25078,0.209119,0.179355,0.998994},
{0.055902,0.057504,0.059427,0.280393,0.270942,0.264978,0.207063,0.998994},
{0.052835,0.01687,0.027826,0.06946,0.051931,0.081926,0.155367,0.998994},
{0.24534,0.05977,0.123506,0.174417,0.157785,0.171243,0.294073,0.175989},
{0.314664,0.298273,0.259561,0.101972,0.097202,0.094587,0.01465,0.152223},
{0.313898,0.265756,0.1756,0.202463,0.202493,0.192545,0.172964,0.161844},
{0.31949,0.224596,0.155687,0.704675,0.668817,0.628046,0.776174,0.095407},
{0.090002,0.085504,0.097269,0.953577,0.975885,0.999998,0.999998,0.085367},
{0.228822,0.214502,0.190149,0.14652,0.144296,0.134111,0.014601,0.173502},
{0.307367,0.299707,0.291574,0.337221,0.301786,0.298807,0.044418,0.08085},
{0.286035,0.113031,0.020441,0.278284,0.278986,0.275758,0.074346,0.107828},
{0.302805,0.197328,0.028421,0.215204,0.2129,0.197336,0.329664,0.145486},
{0.292337,0.21142,0.101862,0.11347,0.107484,0.110216,0.024257,0.200769},
{0.25535,0.217249,0.040262,0.385828,0.37063,0.305383,0.354925,0.090143}
};

private double[,] GGXVGfits = new double[,] {{0.038133,0.029947,0.021249,0.370882,0.289011,0.216425,0.117662,0.461099},
{0.305338,0.281412,0.248102,0.275056,0.285974,0.342279,0.011997,0.13627},
{0.012407,0.013033,0.014619,0.313577,0.288999,0.303407,0.018791,0.825777},
{0.055498,0.062784,0.053938,0.137783,0.12569,0.1285,0.014822,0.148622},
{0.211183,0.139131,0.118173,0.289377,0.270029,0.244852,0.999998,0.998994},
{0.013618,0.00774,0.007133,0.041605,0.034189,0.033983,0.601797,0.172456},
{0.000345,0.000179,0.000244,0.162012,0.151712,0.158983,0.011022,0.140161},
{0.010793,0.00938,0.00867,0.247545,0.243402,0.239267,0.272009,0.199823},
{0.001442,0.001043,0.00078,0.103323,0.104353,0.107713,0.025406,0.364023},
{0.004991,0.004686,0.004709,0.21657,0.216348,0.218187,0.39652,0.199609},
{0.01267,0.036256,0.103986,0.175256,0.155929,0.154047,0.018753,0.143922},
{0.010458,0.011957,0.038255,0.165041,0.18326,0.292215,0.817846,0.341524},
{0.000311,0.000002,0.000707,0.151727,0.136819,0.322214,0.24111,0.998994},
{0.004114,0.00535,0.012094,0.167207,0.243372,0.448022,0.023985,0.58539},
{0.037063,0.075349,0.155359,0.295831,0.298151,0.292657,0.260526,0.129816},
{0.019079,0.016809,0.011621,0.254217,0.167711,0.094362,0.01173,0.974092},
{0.038744,0.015916,0.008552,0.218622,0.214799,0.213434,0.169279,0.188715},
{0.002216,0.001674,0.001848,0.304094,0.286844,0.284113,0.006859,0.998994},
{0.004182,0.003282,0.003076,0.25432,0.22582,0.269357,0.009771,0.902315},
{0.083833,0.025722,0.010763,0.29696,0.270441,0.260309,0.243345,0.176828},
{0.00086,0.001011,0.001438,0.178651,0.224847,0.227747,0.054794,0.353555},
{0.004541,0.005304,0.006876,0.287881,0.224298,0.232614,0.071546,0.53045},
{0.00176,0.001491,0.000951,0.19993,0.209177,0.180612,0.058174,0.341211},
{0.004381,0.009815,0.03779,0.22706,0.192667,0.205347,0.33708,0.21972},
{0.25155,0.031643,0.008852,0.237558,0.213197,0.222162,0.403715,0.170679},
{0.019594,0.008274,0.006311,0.279184,0.254507,0.253648,0.296102,0.119447},
{0.306635,0.294061,0.256586,0.309015,0.292413,0.281946,0.11536,0.107721},
{0.048513,0.034042,0.019024,0.32937,0.32657,0.326913,0.145162,0.139436},
{0.025232,0.010522,0.000002,0.479547,0.330225,0.128687,0.260305,0.998994},
{0.034601,0.026575,0.016229,0.322286,0.283622,0.235942,0.146923,0.998994},
{0.040926,0.025659,0.011652,0.410638,0.316881,0.18316,0.041792,0.881807},
{0.142984,0.074426,0.02543,0.274667,0.223505,0.128336,0.240988,0.998994},
{0.100206,0.100397,0.093591,0.168533,0.171274,0.172487,0.042228,0.169538},
{0.006448,0.006677,0.008142,0.259546,0.248834,0.234796,0.032762,0.998994},
{0.01674,0.074003,0.039911,0.252016,0.257944,0.227274,0.012314,0.142206},
{0.043924,0.039575,0.046848,0.269525,0.385355,0.445123,0.678976,0.151804},
{0.077768,0.115327,0.052503,0.137323,0.150186,0.09379,0.571523,0.520357},
{0.000633,0.014124,0.02144,0.121423,0.278635,0.293298,0.203558,0.590814},
{0.002084,0.007143,0.003206,0.161062,0.295522,0.19441,0.031458,0.309717},
{0.013513,0.079538,0.08699,0.148164,0.123125,0.124307,0.01082,0.151476},
{0.005811,0.005693,0.006006,0.204702,0.206417,0.211786,0.020689,0.34604},
{0.053943,0.019739,0.008081,0.337091,0.322031,0.30311,0.199484,0.149301},
{0.043264,0.01556,0.010225,0.34617,0.234422,0.203355,0.999998,0.157037},
{0.415132,0.040548,0.006096,0.259866,0.234933,0.260385,0.343237,0.180841},
{0.189256,0.033826,0.029951,0.147132,0.14476,0.150703,0.012148,0.165315},
{0.094598,0.03425,0.011507,0.563043,0.52952,0.47561,0.232015,0.118906},
{0.244585,0.20717,0.169626,0.181146,0.18075,0.170923,0.200277,0.270593},
{0.003069,0.002367,0.002142,0.470346,0.426416,0.384706,0.051912,0.998994},
{0.248743,0.24624,0.220544,0.267358,0.305811,0.271143,0.041906,0.045724},
{0.408502,0.134279,0.003305,0.240625,0.207605,0.200349,0.384954,0.225046},
{0.174608,0.155084,0.136194,0.310632,0.267206,0.179529,0.25498,0.998994},
{0.126703,0.09173,0.075494,0.098474,0.098596,0.09646,0.234182,0.815454},
{0.24135,0.179483,0.182924,0.267297,0.27868,0.298746,0.999998,0.998994},
{0.199968,0.043695,0.034982,0.335107,0.212305,0.19877,0.738333,0.998994},
{0.257791,0.171198,0.152673,0.436945,0.431635,0.429132,0.808645,0.520197},
{0.194963,0.121385,0.096658,0.17889,0.180048,0.17906,0.030824,0.164789},
{0.390901,0.092119,0.065832,0.264795,0.205408,0.219461,0.420706,0.141611},
{0.18963,0.209222,0.2129,0.659387,0.560876,0.49447,0.926138,0.515466},
{0.057846,0.018049,0.010564,0.243608,0.170663,0.157289,0.999998,0.577081},
{0.285204,0.250612,0.213251,0.183038,0.176569,0.160242,0.272253,0.188058},
{0.276514,0.03045,0.029691,0.27511,0.271936,0.267755,0.080087,0.154535},
{0.031839,0.035143,0.038877,0.296434,0.295328,0.297235,0.067543,0.1233},
{0.189355,0.021547,0.006355,0.158601,0.05372,0.039632,0.434286,0.428911},
{0.121332,0.013521,0.003282,0.751367,0.179346,0.164301,0.999998,0.233911},
{0.024988,0.002615,0.000703,0.443567,0.115816,0.084444,0.022983,0.507661},
{0.161142,0.023986,0.008333,0.184042,0.203996,0.241937,0.030678,0.159494},
{0.277887,0.048435,0.013538,0.296716,0.2819,0.281839,0.262808,0.169778},
{0.240381,0.035791,0.015024,0.221845,0.222292,0.231374,0.011835,0.110971},
{0.006555,0.00641,0.006603,0.221265,0.207479,0.218555,0.01461,0.21573},
{0.013147,0.016626,0.020059,0.523523,0.511255,0.49917,0.232839,0.998994},
{0.095117,0.100366,0.100977,0.533716,0.483301,0.432642,0.286886,0.998994},
{0.152063,0.119608,0.102121,0.326746,0.340738,0.34646,0.236875,0.998994},
{0.007204,0.003835,0.00196,0.217142,0.214853,0.215547,0.260175,0.208742},
{0.001997,0.002048,0.002266,0.152216,0.146228,0.166597,0.011469,0.165643},
{0.004568,0.012685,0.030408,0.166446,0.144094,0.146745,0.011015,0.173341},
{0.006841,0.024618,0.021513,0.180484,0.155635,0.162729,0.010536,0.160646},
{0.14932,0.02498,0.007269,0.163587,0.145301,0.156503,0.010395,0.169221},
{0.318468,0.051569,0.005565,0.119444,0.114568,0.135566,0.009271,0.175462},
{0.294675,0.03383,0.008192,0.16052,0.141668,0.164026,0.01104,0.169611},
{0.067545,0.016626,0.01926,0.14837,0.136669,0.147283,0.009657,0.176012},
{0.280511,0.225366,0.124879,0.027345,0.034376,0.030857,0.004726,0.998994},
{0.297723,0.130212,0.012884,0.158136,0.13648,0.148271,0.010597,0.171083},
{0.004594,0.003969,0.003885,0.227327,0.197832,0.200132,0.008304,0.998994},
{0.006105,0.005617,0.006174,0.236379,0.221063,0.216402,0.006353,0.998994},
{0.320009,0.311273,0.300249,0.270135,0.274881,0.281274,0.199713,0.174951},
{0.003069,0.002533,0.002477,0.213007,0.195901,0.232343,0.007295,0.998994},
{0.036081,0.028055,0.017374,0.320879,0.289106,0.244543,0.139572,0.998994},
{0.040704,0.04281,0.045053,0.338281,0.326322,0.318998,0.16624,0.998994},
{0.050226,0.014505,0.024232,0.082002,0.063879,0.098016,0.110445,0.998994},
{0.241159,0.055879,0.119279,0.183694,0.169016,0.18239,0.293203,0.230859},
{0.312372,0.295938,0.257364,0.12198,0.116369,0.116079,0.012888,0.156694},
{0.311143,0.262987,0.172746,0.224115,0.224023,0.215051,0.160482,0.179544},
{0.296533,0.200945,0.130472,0.202417,0.201135,0.2035,0.911001,0.768495},
{0.066911,0.061761,0.071962,0.176431,0.181146,0.190027,0.999998,0.998994},
{0.226282,0.211977,0.187769,0.159387,0.156538,0.145288,0.013351,0.197305},
{0.305688,0.298151,0.289888,0.365701,0.331499,0.332071,0.034393,0.085336},
{0.284036,0.111223,0.018659,0.339105,0.34939,0.374414,0.05385,0.104524},
{0.296808,0.19201,0.023721,0.206285,0.207422,0.193086,0.362112,0.219095},
{0.288675,0.20804,0.099138,0.129114,0.124551,0.128183,0.021265,0.212946},
{0.252786,0.214571,0.037943,0.309717,0.302057,0.252557,0.332144,0.134576}
};

private double[,] GGXSMSfits = new double[,] {{0.040414,0.031778,0.022592,0.436517,0.33938,0.254984,0.105442,0.37179},
{0.305826,0.281831,0.248346,0.260904,0.27601,0.332189,0.011976,0.144189},
{0.013078,0.013788,0.015482,0.287569,0.260694,0.272863,0.015999,0.992647},
{0.05549,0.062784,0.05393,0.137863,0.125818,0.12861,0.014801,0.148607},
{0.133936,0.056528,0.029543,0.999998,0.999998,0.999994,0.856863,0.493951},
{0.01272,0.006982,0.00625,0.228662,0.190088,0.197412,0.65209,0.076074},
{0.000343,0.000177,0.00024,0.162078,0.151783,0.159147,0.011022,0.140138},
{0.010011,0.008552,0.007814,0.394266,0.389574,0.384477,0.26705,0.143251},
{0.001424,0.001028,0.000763,0.103857,0.104829,0.108255,0.025387,0.362283},
{0.001148,0.000822,0.000787,0.503282,0.503893,0.508951,0.425657,0.13273},
{0.012659,0.036249,0.10399,0.1756,0.156206,0.154237,0.018749,0.143785},
{0.00037,0.000785,0.024551,0.640264,0.707132,0.999998,0.75884,0.183954},
{0.000002,0.000002,0.000002,0.155557,0.137354,0.328699,0.2208,0.962251},
{0.004076,0.005289,0.011972,0.168104,0.244646,0.450315,0.023979,0.581941},
{0.037305,0.075758,0.155901,0.556108,0.553308,0.54072,0.25157,0.080362},
{0.019052,0.016794,0.011606,0.2549,0.168169,0.094598,0.011736,0.969942},
{0.038452,0.01564,0.008295,0.293352,0.28927,0.285829,0.167257,0.149744},
{0.002199,0.001661,0.001834,0.304346,0.28708,0.284319,0.006864,0.998994},
{0.00416,0.003259,0.003053,0.254495,0.225938,0.269388,0.009775,0.902559},
{0.083356,0.025116,0.009983,0.444406,0.408029,0.398149,0.239515,0.131799},
{0.000774,0.000902,0.001329,0.183107,0.230516,0.233461,0.054462,0.344904},
{0.004083,0.00493,0.006509,0.304865,0.237848,0.246286,0.071567,0.498193},
{0.001646,0.001379,0.000864,0.205911,0.21554,0.185953,0.057825,0.331445},
{0.001838,0.007473,0.035091,0.437223,0.372812,0.395082,0.348455,0.149946},
{0.250192,0.031047,0.007784,0.604822,0.53087,0.5748,0.403517,0.093591},
{0.019392,0.007894,0.006023,0.509401,0.474214,0.468484,0.285208,0.079599},
{0.311067,0.299158,0.261713,0.402155,0.352533,0.313257,0.08279,0.060876},
{0.048362,0.03388,0.018818,0.396158,0.392976,0.3948,0.141859,0.120981},
{0.000002,0.000002,0.000002,0.545068,0.354944,0.120523,0.237371,0.998994},
{0.029504,0.022195,0.012811,0.337831,0.297334,0.247011,0.150001,0.998994},
{0.044214,0.027982,0.012842,0.398157,0.309496,0.180338,0.036848,0.871797},
{0.13463,0.06769,0.02173,0.417276,0.340509,0.195566,0.245634,0.619745},
{0.100168,0.100366,0.093553,0.170772,0.173528,0.174829,0.042217,0.167749},
{0.006281,0.006555,0.00802,0.260095,0.249231,0.235193,0.032739,0.998994},
{0.016687,0.073892,0.039789,0.263177,0.266958,0.240381,0.012502,0.136392},
{0.039262,0.034212,0.043596,0.74502,0.999998,0.999998,0.60539,0.10174},
{0.055811,0.089944,0.037477,0.650018,0.723047,0.450739,0.659979,0.251566},
{0.000002,0.009946,0.016904,0.148447,0.379358,0.399713,0.204275,0.446359},
{0.00205,0.007085,0.003168,0.162515,0.298067,0.196153,0.031442,0.307291},
{0.013509,0.07953,0.086986,0.14818,0.123151,0.124368,0.010813,0.151521},
{0.005788,0.005678,0.005991,0.205356,0.207086,0.212438,0.020639,0.345125},
{0.05306,0.018941,0.007316,0.463068,0.442117,0.417719,0.199636,0.121423},
{0.034004,0.005956,0.002439,0.999998,0.851015,0.718668,0.886892,0.126131},
{0.412881,0.039703,0.004594,0.550485,0.481439,0.553529,0.343683,0.112001},
{0.189249,0.033823,0.029949,0.14702,0.144683,0.150571,0.012132,0.165468},
{0.096552,0.035883,0.012292,0.794397,0.79104,0.768335,0.206503,0.080499},
{0.244638,0.207239,0.169679,0.253015,0.253412,0.241266,0.194341,0.196802},
{0.0023,0.001695,0.001566,0.471246,0.427049,0.385172,0.051931,0.998994},
{0.248743,0.24624,0.220483,0.280084,0.320642,0.284143,0.041891,0.044092},
{0.410616,0.135545,0.004161,0.598276,0.533594,0.519922,0.367483,0.104395},
{0.15899,0.141656,0.127367,0.378564,0.326486,0.219705,0.265974,0.904642},
{0.131342,0.097742,0.08172,0.213617,0.211481,0.20498,0.208891,0.267572},
{0.17489,0.115656,0.123994,0.999998,0.999998,0.999998,0.829992,0.43757},
{0.188951,0.01568,0.009683,0.999998,0.861002,0.801691,0.686529,0.328806},
{0.227274,0.139612,0.120752,0.999998,0.999998,0.999998,0.69,0.32464},
{0.194971,0.121378,0.096651,0.179775,0.180963,0.180009,0.030672,0.164011},
{0.385553,0.089769,0.063806,0.999998,0.691919,0.714471,0.45986,0.07496},
{0.042902,0.049188,0.043741,0.999998,0.999998,0.999998,0.799986,0.760721},
{0.048147,0.000002,0.000002,0.999998,0.963235,0.7754,0.916723,0.215509},
{0.286539,0.25184,0.214082,0.340753,0.329584,0.30488,0.260511,0.105783},
{0.276666,0.028635,0.028703,0.313089,0.309854,0.301965,0.08132,0.145807},
{0.031751,0.035059,0.038793,0.311319,0.310037,0.312051,0.067167,0.11889},
{0.177713,0.017809,0.002058,0.474008,0.161554,0.136835,0.495962,0.246225},
{0.127,0.006261,0.000002,0.999998,0.480417,0.354013,0.779997,0.173273},
{0.02487,0.002588,0.000688,0.446512,0.116602,0.085001,0.022995,0.503999},
{0.161142,0.023973,0.008312,0.184942,0.205145,0.243356,0.030483,0.158853},
{0.274538,0.046754,0.012207,0.51684,0.46972,0.463983,0.268621,0.123849},
{0.239938,0.035715,0.014963,0.237169,0.236703,0.250562,0.012075,0.103418},
{0.006488,0.006343,0.00653,0.226562,0.212156,0.222686,0.015354,0.210504},
{0.000002,0.000002,0.000002,0.551965,0.550714,0.548502,0.21105,0.998994},
{0.000002,0.000002,0.001581,0.9992,0.966272,0.905298,0.340002,0.697847},
{0.138773,0.105936,0.088464,0.362787,0.377634,0.383127,0.245306,0.998972},
{0.00588,0.002466,0.00066,0.337129,0.334512,0.333013,0.265127,0.158228},
{0.001993,0.002046,0.002262,0.152172,0.146135,0.166374,0.011451,0.165842},
{0.004564,0.01268,0.030405,0.166107,0.143739,0.146389,0.010998,0.173799},
{0.006837,0.024614,0.021505,0.180339,0.155441,0.162569,0.010528,0.160829},
{0.149324,0.024976,0.007265,0.163419,0.145197,0.156454,0.010383,0.169359},
{0.318475,0.051565,0.005563,0.119243,0.114378,0.135439,0.009262,0.175752},
{0.294679,0.033834,0.008188,0.160289,0.141485,0.16382,0.011024,0.169878},
{0.067545,0.016622,0.019258,0.148061,0.136388,0.14694,0.009647,0.176393},
{0.280511,0.225122,0.124647,0.027414,0.034464,0.030935,0.004732,0.998994},
{0.297723,0.130212,0.012884,0.157863,0.136272,0.148077,0.01058,0.171327},
{0.004449,0.003831,0.00374,0.233652,0.201402,0.202249,0.008466,0.998994},
{0.005823,0.005304,0.005796,0.245889,0.22693,0.223215,0.006511,0.998994},
{0.320886,0.313043,0.302316,0.438196,0.440332,0.445032,0.194708,0.114679},
{0.003057,0.002523,0.002468,0.213113,0.195963,0.232423,0.007299,0.998994},
{0.030817,0.023477,0.013773,0.338361,0.304662,0.257173,0.142656,0.998994},
{0.034219,0.036493,0.038812,0.357492,0.345255,0.337732,0.169731,0.998972},
{0.049455,0.013986,0.023416,0.084108,0.065248,0.10032,0.11181,0.998994},
{0.240419,0.054809,0.118326,0.340143,0.319162,0.340005,0.294134,0.146059},
{0.312379,0.29593,0.257364,0.122133,0.116491,0.116222,0.012878,0.156526},
{0.311502,0.263361,0.173067,0.286249,0.286432,0.277368,0.153875,0.140863},
{0.240358,0.144472,0.07448,0.999998,0.999998,0.999998,0.84313,0.352884},
{0.004053,0.000002,0.012003,0.999998,0.999998,0.999998,0.949064,0.395494},
{0.227014,0.212717,0.188425,0.145099,0.142767,0.131111,0.012632,0.211984},
{0.305711,0.298128,0.289903,0.369253,0.334482,0.335107,0.034202,0.084558},
{0.284017,0.111185,0.018621,0.350153,0.360918,0.386713,0.053365,0.101816},
{0.297685,0.19272,0.024187,0.448251,0.455103,0.427988,0.345754,0.115549},
{0.288683,0.208047,0.09913,0.129831,0.125253,0.1289,0.021259,0.211954},
{0.249345,0.211763,0.036661,0.824518,0.778894,0.605005,0.357488,0.080362}
};

private double[,] MSVGfits = new double[,] {{0.036111,0.028284,0.019922,0.384485,0.300745,0.227663,0.12832,0.446581},
{0.305376,0.281427,0.248102,0.27231,0.283151,0.338853,0.01198,0.137376},
{0.013109,0.013811,0.015504,0.285875,0.259294,0.27131,0.016062,0.998994},
{0.05549,0.06278,0.053934,0.136562,0.124548,0.127374,0.014856,0.149599},
{0.245203,0.17029,0.147272,0.290552,0.275049,0.242456,0.999998,0.375513},
{0.015062,0.008836,0.008184,0.019006,0.016336,0.017625,0.99999,0.170251},
{0.000345,0.000179,0.000244,0.161165,0.1509,0.158155,0.01102,0.140695},
{0.010435,0.009019,0.008308,0.215463,0.21235,0.209161,0.283926,0.222047},
{0.001466,0.001072,0.00081,0.098192,0.098783,0.101083,0.024826,0.383936},
{0.004818,0.004516,0.004533,0.190233,0.190034,0.191667,0.413984,0.216455},
{0.012663,0.036241,0.103983,0.172174,0.153284,0.151498,0.018884,0.145723},
{0.013082,0.014963,0.04392,0.168703,0.186258,0.287134,0.868147,0.268915},
{0.000452,0.000002,0.00094,0.145319,0.130426,0.308679,0.244024,0.998994},
{0.004083,0.005296,0.011995,0.162973,0.237115,0.436563,0.024223,0.604585},
{0.036569,0.074762,0.154718,0.253946,0.258279,0.253183,0.281484,0.148027},
{0.019044,0.016809,0.011613,0.251691,0.165926,0.093328,0.01173,0.991182},
{0.03848,0.015804,0.00851,0.205484,0.200815,0.19716,0.175447,0.197038},
{0.002212,0.001672,0.001846,0.303949,0.286897,0.283975,0.006861,0.998994},
{0.004175,0.003271,0.003069,0.252576,0.224275,0.267439,0.009773,0.912813},
{0.083498,0.025442,0.010549,0.254434,0.231279,0.221658,0.250845,0.199213},
{0.00086,0.001031,0.001474,0.183145,0.226747,0.229333,0.055631,0.342111},
{0.00416,0.004968,0.006517,0.28692,0.223718,0.231561,0.075243,0.531244},
{0.00181,0.001541,0.00098,0.191625,0.200086,0.174104,0.058143,0.349222},
{0.004163,0.009603,0.037588,0.19848,0.168756,0.179674,0.350141,0.24093},
{0.251398,0.031351,0.008432,0.208826,0.193338,0.203844,0.436865,0.183229},
{0.019256,0.008009,0.00605,0.243181,0.220705,0.219873,0.313734,0.132654},
{0.3024,0.289102,0.252023,0.243711,0.239832,0.235559,0.162481,0.169656},
{0.048235,0.033853,0.018846,0.263177,0.258203,0.255869,0.149252,0.168336},
{0.008287,0.001337,0.000002,0.509515,0.33848,0.113123,0.252264,0.998994},
{0.026941,0.019846,0.011091,0.354173,0.313963,0.261385,0.168705,0.96972},
{0.043359,0.027368,0.012506,0.393949,0.3062,0.178705,0.03894,0.893404},
{0.142816,0.074285,0.025369,0.264185,0.215036,0.123361,0.245916,0.998994},
{0.099947,0.100122,0.093317,0.156217,0.159032,0.160135,0.045496,0.181573},
{0.006342,0.006555,0.00802,0.257791,0.248102,0.234094,0.033188,0.998994},
{0.016695,0.073907,0.039804,0.259981,0.263696,0.237314,0.012481,0.13772},
{0.044328,0.039991,0.047334,0.237573,0.342599,0.395746,0.724958,0.157304},
{0.081276,0.119531,0.05483,0.128198,0.138132,0.08793,0.577932,0.435701},
{0.000539,0.01333,0.020517,0.084634,0.198007,0.208719,0.207128,0.917802},
{0.002206,0.007566,0.003408,0.15687,0.281274,0.187364,0.030144,0.3155},
{0.013509,0.079523,0.086988,0.147489,0.122591,0.123756,0.01082,0.152025},
{0.00575,0.00564,0.005945,0.201536,0.203411,0.20874,0.021335,0.349306},
{0.053762,0.019579,0.00797,0.289072,0.27569,0.258539,0.204115,0.166872},
{0.045831,0.017103,0.011547,0.308374,0.214166,0.18606,0.999998,0.134962},
{0.415186,0.040168,0.005661,0.216562,0.201364,0.223169,0.364843,0.2036},
{0.189249,0.03383,0.029951,0.146291,0.143953,0.149858,0.012144,0.166071},
{0.094156,0.033857,0.011234,0.48504,0.455499,0.406671,0.242224,0.132326},
{0.24357,0.205919,0.167993,0.129327,0.128427,0.120905,0.215841,0.407533},
{0.003069,0.002374,0.002164,0.466165,0.421571,0.379709,0.051872,0.998994},
{0.247583,0.244043,0.216608,0.203897,0.203943,0.197443,0.081552,0.123346},
{0.40719,0.135484,0.002771,0.217126,0.187921,0.189767,0.418096,0.232961},
{0.174898,0.155321,0.136522,0.296594,0.255136,0.170953,0.259901,0.998994},
{0.13009,0.096765,0.080865,0.099237,0.097131,0.093748,0.219724,0.619112},
{0.270868,0.209299,0.218393,0.315088,0.337366,0.331171,0.999998,0.341333},
{0.228006,0.057825,0.048212,0.393213,0.270746,0.253381,0.75408,0.453355},
{0.280328,0.191644,0.173883,0.429102,0.439478,0.428735,0.831938,0.324396},
{0.194757,0.121225,0.096506,0.170347,0.171232,0.170118,0.032478,0.172037},
{0.39052,0.091524,0.065134,0.231836,0.184015,0.197717,0.469114,0.158487},
{0.227899,0.241068,0.241388,0.67605,0.584131,0.510645,0.937376,0.277185},
{0.076608,0.030016,0.0212,0.270883,0.204935,0.19404,0.999998,0.238451},
{0.284288,0.249689,0.21216,0.151788,0.145807,0.131952,0.297094,0.233492},
{0.273576,0.030801,0.029306,0.203012,0.19906,0.201929,0.080871,0.190363},
{0.032041,0.03541,0.039194,0.26613,0.262003,0.261575,0.064781,0.132867},
{0.206888,0.027246,0.009767,0.028711,0.01037,0.009149,0.364797,0.998994},
{0.134302,0.016071,0.005474,0.680353,0.173029,0.160883,0.999998,0.178148},
{0.024774,0.00258,0.000684,0.436876,0.11416,0.083147,0.023411,0.517732},
{0.161333,0.024057,0.008379,0.183,0.200765,0.235132,0.030538,0.160455},
{0.277818,0.048086,0.013227,0.250879,0.241434,0.240701,0.273443,0.191171},
{0.240381,0.035806,0.015024,0.219274,0.219724,0.228567,0.011801,0.112024},
{0.006494,0.006349,0.006536,0.224603,0.210384,0.220783,0.015424,0.211671},
{0.004831,0.006967,0.009912,0.521967,0.516809,0.50802,0.215429,0.998994},
{0.087671,0.093164,0.093896,0.484277,0.439844,0.395044,0.316992,0.998994},
{0.152139,0.119623,0.102129,0.313409,0.32702,0.332544,0.24111,0.998994},
{0.007097,0.003746,0.001888,0.188821,0.186517,0.186845,0.2656,0.230051},
{0.001995,0.002048,0.002264,0.151394,0.145418,0.165693,0.011467,0.166444},
{0.004566,0.012682,0.030408,0.165624,0.143409,0.146024,0.011003,0.174104},
{0.006841,0.024618,0.021513,0.179584,0.154855,0.161945,0.010526,0.161317},
{0.149309,0.02498,0.007267,0.162943,0.144762,0.155922,0.010389,0.169756},
{0.318475,0.051565,0.005565,0.118894,0.114038,0.134967,0.00926,0.176149},
{0.294679,0.033834,0.008192,0.159711,0.14092,0.163171,0.01103,0.170351},
{0.067541,0.016624,0.019262,0.147689,0.13606,0.146562,0.009647,0.176714},
{0.279375,0.22439,0.124323,0.027954,0.034933,0.031129,0.004732,0.998994},
{0.297723,0.130212,0.012884,0.157259,0.135698,0.147558,0.010582,0.171907},
{0.004457,0.003839,0.003751,0.233484,0.201307,0.202169,0.008465,0.998994},
{0.00583,0.005312,0.0058,0.245706,0.22677,0.223062,0.006511,0.998994},
{0.318857,0.309854,0.298738,0.220483,0.225519,0.23147,0.212301,0.2157},
{0.003065,0.002529,0.002475,0.212995,0.195821,0.23229,0.007297,0.998994},
{0.024049,0.017854,0.009859,0.355772,0.318113,0.264524,0.172895,0.998994},
{0.030969,0.032953,0.034975,0.365717,0.355184,0.349435,0.194069,0.998994},
{0.047975,0.013193,0.022241,0.118576,0.091671,0.139154,0.129112,0.653528},
{0.239648,0.054605,0.117792,0.16601,0.151682,0.164667,0.328199,0.266374},
{0.312372,0.295946,0.257375,0.120573,0.115011,0.114698,0.012853,0.158144},
{0.310754,0.262445,0.169153,0.083185,0.082712,0.079584,0.176443,0.66263},
{0.31862,0.22265,0.15323,0.20614,0.20675,0.200586,0.854246,0.292352},
{0.087865,0.083177,0.095102,0.207651,0.21377,0.217859,0.999998,0.318719},
{0.227777,0.21351,0.189188,0.129968,0.127889,0.11626,0.011972,0.232019},
{0.305498,0.297937,0.289713,0.335725,0.304636,0.305261,0.035723,0.091882},
{0.283357,0.110666,0.018369,0.303247,0.310079,0.323648,0.059593,0.116899},
{0.29619,0.191476,0.022998,0.178674,0.180826,0.170801,0.388601,0.245592},
{0.288629,0.207994,0.099077,0.126363,0.121721,0.125303,0.021562,0.217935},
{0.25181,0.213571,0.037004,0.278162,0.270654,0.226526,0.374929,0.153024}
};


private double[,] Heitzfits = new double[,] {
{0.036417,0.028566,0.020227,0.384981,0.300291,0.224695,0.116112,0.443300},
{0.307214,0.283105,0.248987,0.229410,0.256609,0.308984,0.012193,0.172868},
{0.012285,0.012918,0.014490,0.310976,0.286760,0.301042,0.018934,0.833253},
{0.055608,0.062921,0.054094,0.126978,0.116449,0.118036,0.013679,0.160371},
{0.166170,0.089609,0.071260,0.999998,0.999998,0.924677,0.839346,0.386026},
{0.013061,0.007207,0.006572,0.137514,0.114709,0.116304,0.620428,0.090952},
{0.000379,0.000206,0.000270,0.107793,0.106165,0.110399,0.008730,0.195428},
{0.010158,0.008691,0.007946,0.331102,0.327432,0.323305,0.256254,0.156412},
{0.001455,0.001064,0.000801,0.101072,0.101553,0.103967,0.024479,0.373499},
{0.001073,0.000747,0.000711,0.411424,0.411928,0.416132,0.418325,0.145654},
{0.012647,0.036226,0.103960,0.174142,0.155050,0.153333,0.018928,0.144350},
{0.005106,0.006414,0.029398,0.513727,0.561151,0.890680,0.744367,0.170816},
{0.004037,0.005243,0.011880,0.168401,0.245065,0.451288,0.024156,0.580721},
{0.000002,0.000002,0.000002,0.147638,0.132257,0.315141,0.217970,0.979707},
{0.037012,0.075336,0.155321,0.459100,0.462183,0.452524,0.252729,0.091005},
{0.019025,0.016794,0.011606,0.254850,0.168054,0.094530,0.011724,0.970796},
{0.038148,0.015407,0.008102,0.265268,0.260866,0.256586,0.167623,0.160570},
{0.002203,0.001663,0.001838,0.304376,0.287126,0.284212,0.006826,0.998994},
{0.004148,0.003252,0.003046,0.258020,0.228925,0.272714,0.009853,0.878145},
{0.083131,0.024831,0.009683,0.398355,0.366281,0.357477,0.240141,0.140352},
{0.000772,0.000900,0.001331,0.178686,0.224733,0.227682,0.053684,0.352243},
{0.003709,0.004671,0.006219,0.288183,0.222803,0.230798,0.071991,0.539091},
{0.001634,0.001369,0.000856,0.197755,0.206888,0.178468,0.057123,0.343546},
{0.001133,0.006816,0.034320,0.376215,0.321375,0.341852,0.352804,0.165483},
{0.250772,0.031459,0.008150,0.462762,0.409959,0.446539,0.383550,0.103330},
{0.019336,0.007881,0.005989,0.419550,0.389429,0.384966,0.279501,0.088014},
{0.313837,0.302698,0.265527,0.496240,0.408105,0.321375,0.074438,0.038095},
{0.048406,0.033918,0.018839,0.356439,0.353479,0.355295,0.137808,0.128610},
{0.022516,0.016321,0.008508,0.352300,0.307672,0.251443,0.159931,0.998972},
{0.044168,0.027910,0.012827,0.399751,0.310770,0.181024,0.036655,0.865205},
{0.000002,0.000002,0.000002,0.537515,0.349252,0.118356,0.232580,0.974214},
{0.133470,0.066682,0.021116,0.384409,0.312860,0.178766,0.239980,0.665430},
{0.100435,0.100633,0.093813,0.170467,0.172723,0.173547,0.040071,0.166788},
{0.005792,0.005975,0.007303,0.261560,0.250513,0.237482,0.032995,0.998994},
{0.016458,0.073381,0.039289,0.301889,0.292314,0.288362,0.013698,0.122308},
{0.039835,0.034362,0.042619,0.677942,0.944429,0.999998,0.623388,0.100084},
{0.063554,0.098985,0.042749,0.442529,0.492212,0.302621,0.603155,0.264078},
{0.002020,0.006994,0.003122,0.161260,0.296293,0.194803,0.031908,0.309183},
{0.000002,0.009481,0.016405,0.135049,0.349512,0.368692,0.200392,0.474069},
{0.014482,0.081819,0.089521,0.028431,0.029483,0.032281,0.005543,0.673647},
{0.005750,0.005636,0.005945,0.204439,0.206150,0.211656,0.021002,0.345186},
{0.052652,0.018623,0.007064,0.412454,0.392038,0.369173,0.200254,0.131174},
{0.036981,0.011022,0.006435,0.999998,0.698930,0.599123,0.854986,0.103197},
{0.412698,0.039260,0.004263,0.471902,0.413786,0.470872,0.344831,0.122240},
{0.189249,0.033819,0.029947,0.146673,0.144212,0.150154,0.012161,0.165666},
{0.095056,0.034418,0.010919,0.773950,0.770166,0.747461,0.218023,0.084467},
{0.243974,0.206514,0.168871,0.234491,0.234644,0.223474,0.200231,0.212137},
{0.002065,0.001489,0.001360,0.467428,0.424524,0.384149,0.052507,0.998994},
{0.248560,0.246027,0.220331,0.276178,0.315454,0.280298,0.042242,0.045724},
{0.410768,0.135652,0.004247,0.470087,0.419733,0.408777,0.356176,0.117548},
{0.156770,0.139780,0.126184,0.360513,0.309778,0.206979,0.260397,0.938760},
{0.130655,0.096552,0.080492,0.190393,0.189355,0.184061,0.217962,0.308191},
{0.198221,0.034303,0.026437,0.999998,0.726709,0.677545,0.640951,0.282007},
{0.182031,0.121484,0.127344,0.986719,0.988672,0.994531,0.810781,0.410547},
{0.237886,0.150430,0.131776,0.999998,0.999998,0.999998,0.676977,0.280054},
{0.195818,0.121942,0.097133,0.179758,0.180299,0.179231,0.028894,0.162836},
{0.385835,0.090356,0.064554,0.728021,0.512231,0.528589,0.429807,0.081659},
{0.166330,0.172220,0.166650,0.999998,0.999998,0.999998,0.706114,0.366083},
{0.051576,0.010917,0.003019,0.999998,0.771265,0.732980,0.926771,0.193178},
{0.287370,0.252611,0.214624,0.277643,0.268335,0.248651,0.244818,0.113412},
{0.269540,0.030393,0.028509,0.334085,0.320016,0.342294,0.082111,0.124399},
{0.031541,0.034830,0.038549,0.290613,0.290155,0.292696,0.069483,0.125223},
{0.123811,0.008100,0.000002,0.999998,0.386789,0.314737,0.782018,0.170953},
{0.175134,0.017065,0.001596,0.400812,0.133524,0.111642,0.504110,0.281084},
{0.024862,0.002580,0.000681,0.446558,0.116640,0.085039,0.022951,0.503603},
{0.161279,0.024046,0.008367,0.186491,0.208467,0.247491,0.028909,0.158052},
{0.274622,0.046651,0.012075,0.448053,0.404947,0.398660,0.265325,0.134256},
{0.238412,0.035417,0.014761,0.289278,0.287786,0.324766,0.013296,0.084093},
{0.006540,0.006399,0.006591,0.220239,0.206394,0.217420,0.014597,0.216577},
{0.000002,0.000002,0.004648,0.999998,0.971765,0.892480,0.321913,0.678926},
{0.000002,0.000002,0.000002,0.541162,0.540979,0.540186,0.206358,0.986299},
{0.139314,0.106279,0.088693,0.347894,0.363138,0.368890,0.233892,0.998994},
{0.005708,0.002296,0.000446,0.283128,0.281427,0.281667,0.260870,0.175138},
{0.002374,0.002481,0.002802,0.037071,0.040329,0.043562,0.005815,0.661531},
{0.004854,0.013124,0.031137,0.059930,0.058839,0.059904,0.007122,0.462923},
{0.007204,0.025339,0.022218,0.045042,0.049652,0.050222,0.006231,0.595811},
{0.151857,0.025797,0.007585,0.049871,0.051984,0.054514,0.006494,0.524812},
{0.323389,0.052530,0.006021,0.031572,0.033538,0.034130,0.005453,0.691316},
{0.300058,0.034631,0.008607,0.048444,0.050905,0.053699,0.006620,0.534090},
{0.067709,0.016687,0.019334,0.127187,0.118963,0.127977,0.008985,0.204103},
{0.280511,0.225153,0.124765,0.027345,0.034389,0.030866,0.004726,0.998994},
{0.302515,0.132333,0.013597,0.051401,0.051530,0.051412,0.006828,0.526544},
{0.004449,0.003831,0.003748,0.233423,0.201250,0.202127,0.008446,0.998994},
{0.005823,0.005308,0.005792,0.245653,0.226663,0.222971,0.006502,0.998994},
{0.319620,0.311334,0.300417,0.383844,0.387354,0.394220,0.200231,0.129617},
{0.003057,0.002525,0.002468,0.213350,0.196176,0.232862,0.007261,0.998994},
{0.022501,0.016458,0.008600,0.357900,0.319414,0.264787,0.154512,0.998994},
{0.028787,0.031091,0.033411,0.363264,0.351530,0.344091,0.175541,0.998991},
{0.049692,0.014078,0.023470,0.081916,0.063837,0.098753,0.107399,0.998994},
{0.241006,0.055343,0.118951,0.276285,0.261682,0.277643,0.277319,0.158945},
{0.312395,0.295938,0.257394,0.121149,0.115579,0.115249,0.012789,0.157442},
{0.310724,0.262575,0.172357,0.261819,0.261957,0.252954,0.159727,0.153986},
{0.040079,0.035951,0.048006,0.999998,0.999998,0.999998,0.994291,0.285440},
{0.278314,0.180238,0.108667,0.835550,0.866266,0.889459,0.806509,0.257349},
{0.227075,0.212778,0.188501,0.141607,0.139337,0.127863,0.012398,0.214578},
{0.305688,0.298120,0.289880,0.361215,0.327261,0.327966,0.034151,0.085764},
{0.284387,0.111459,0.018774,0.348917,0.361696,0.391290,0.049825,0.100126},
{0.298151,0.193048,0.024425,0.370203,0.375146,0.353075,0.336042,0.125349},
{0.288705,0.208063,0.099146,0.128637,0.124113,0.127771,0.021072,0.213068},
{0.251154,0.213319,0.037523,0.589182,0.560876,0.446619,0.321592,0.088815},
};
	
private string[] matnames = new string[] {"alum-bronze",
"alumina-oxide",
"aluminium",
"aventurnine",
"beige-fabric",
"black-fabric",
"black-obsidian",
"black-oxidized-steel",
"black-phenolic",
"black-soft-plastic",
"blue-acrylic",
"blue-fabric",
"blue-metallic-paint2",
"blue-metallic-paint",
"blue-rubber",
"brass",
"cherry-235",
"chrome",
"chrome-steel",
"colonial-maple-223",
"color-changing-paint1",
"color-changing-paint2",
"color-changing-paint3",
"dark-blue-paint",
"dark-red-paint",
"dark-specular-fabric",
"delrin",
"fruitwood-241",
"gold-metallic-paint2",
"gold-metallic-paint3",
"gold-metallic-paint",
"gold-paint",
"gray-plastic",
"grease-covered-steel",
"green-acrylic",
"green-fabric",
"green-latex",
"green-metallic-paint2",
"green-metallic-paint",
"green-plastic",
"hematite",
"ipswich-pine-221",
"light-brown-fabric",
"light-red-paint",
"maroon-plastic",
"natural-209",
"neoprene-rubber",
"nickel",
"nylon",
"orange-paint",
"pearl-paint",
"pickled-oak-260",
"pink-fabric2",
"pink-fabric",
"pink-felt",
"pink-jasper",
"pink-plastic",
"polyethylene",
"polyurethane-foam",
"pure-rubber",
"purple-paint",
"pvc",
"red-fabric2",
"red-fabric",
"red-metallic-paint",
"red-phenolic",
"red-plastic",
"red-specular-plastic",
"silicon-nitrade",
"silver-metallic-paint2",
"silver-metallic-paint",
"silver-paint",
"special-walnut-224",
"specular-black-phenolic",
"specular-blue-phenolic",
"specular-green-phenolic",
"specular-maroon-phenolic",
"specular-orange-phenolic",
"specular-red-phenolic",
"specular-violet-phenolic",
"specular-white-phenolic",
"specular-yellow-phenolic",
"ss440",
"steel",
"teflon",
"tungsten-carbide",
"two-layer-gold",
"two-layer-silver",
"violet-acrylic",
"violet-rubber",
"white-acrylic",
"white-diffuse-bball",
"white-fabric2",
"white-fabric",
"white-marble",
"white-paint",
"yellow-matte-plastic",
"yellow-paint",
"yellow-phenolic",
"yellow-plastic"
};
	
	public void showOrHideMSText(){
		if(activeBRDFnumber==2) MSText.transform.localScale = new Vector3(1.0f, 1.0f, 1.0f);
		else MSText.transform.localScale = new Vector3(0.0f, 1.0f, 1.0f);
	}
	
	public string getMERLname(int i){
		return matnames[i];
	}
	
	private void updateStrings(){
		if(mi==0){
		prevtext.text = matnames[99] + " (p)";
			curtext.text = matnames[0]+ " (c)";
			nexttext.text = matnames[1]+ " (n)";
			return;
		}
		if(mi==99){
			prevtext.text = matnames[98]+ " (p)";
			curtext.text = matnames[99]+ " (c)";
			nexttext.text = matnames[0]+ " (n)";
			return;
		}
		prevtext.text = matnames[mi-1]+ " (p)";
		curtext.text = matnames[mi]+ " (c)";
		nexttext.text = matnames[mi+1]+ " (n)";
	}
	
	public void MERLnext(){
		if(countdown>0){return;}
		mi++;
		if(mi>99){mi=0;}
		changeMERLMaterial(mi);
		countdown = 20;
	}
	
	public void MERLback(){
		if(countdown>0){return;}
		mi=mi-1;
		if(mi<0){mi=99;}
		changeMERLMaterial(mi);
		countdown = 20;
	}
	
	public void changeMERLMaterial(int i){
		mi = i;
		BRDFMaterials[0]=MERLMaterials[i];
		changeBRDF(activeBRDFnumber);//Do we want to default to switch the active BRDF to MERL?
		maybeFit();
		updateStrings();
		updateMatCanvas();
	}
	
	private void topChangeMaterial(GameObject go, Material m){
		ChangeMaterial changescript = (ChangeMaterial) go.GetComponent(typeof(ChangeMaterial));
		changescript.changeMaterial(m);
	}
	

	public void changeBRDF(int BRDF){
		activeBRDFnumber = BRDF;
		topChangeMaterial(activeobj, BRDFMaterials[BRDF]);
		activeMaterialForPlot = BRDFMaterials[BRDF];
		maybeFit();
		if(BRDF==0){MERLButtons.selectButton(0);}
		else{MERLButtons.selectButton(1);}
		showOrHideMSText();
		return;
	}

	public void SetRoughness(float alpha){
		foreach(Material m in BRDFMaterials){
			//m.SetFloat("_GlossMapScale",smoothness);
			m.SetFloat("_RoughnessAlpha",alpha);
		}
	}
	
	public void SetAnisotropic(float alpha){
		foreach(Material m in BRDFMaterials){
			//m.SetFloat("_GlossMapScale",smoothness);
			m.SetFloat("_Anisotropic",alpha);
		}
	}
	
	public void SetAnisotropicAxis(int axis){
		foreach(Material m in BRDFMaterials){
			//m.SetFloat("_GlossMapScale",smoothness);
			if(axis==0){m.SetFloat("_ax",1.0f);m.SetFloat("_ay",0.0f);m.SetFloat("_az",0.0f);}
			else{if(axis==2){m.SetFloat("_ax",0.0f);m.SetFloat("_ay",0.0f);m.SetFloat("_az",1.0f);}
			else{m.SetFloat("_ax",0.0f);m.SetFloat("_ay",1.0f);m.SetFloat("_az",0.0f);}}
		}
	}
	
	public void SetSpecularScale(float s){
		Color speccolor = s*Color.white;//new Color(d,d,d,1.0f);
		foreach(Material m in BRDFMaterials){
			m.SetColor("_SpecColor",speccolor);
		}
		
	}
	
	public void SetDiffuseRed(float dr){
		foreach(Material m in BRDFMaterials){
			m.SetFloat("_dr",dr);
		}	
	}
	
	public void SetDiffuseGreen(float dg){
		foreach(Material m in BRDFMaterials){
			m.SetFloat("_dg",dg);
		}	
	}
	
	public void SetDiffuseBlue(float db){
		foreach(Material m in BRDFMaterials){
			m.SetFloat("_db",db);
		}	
	}
	
	public void SetSpecularRed(float sr){
		foreach(Material m in BRDFMaterials){
			m.SetFloat("_sr",sr);
		}	
	}
	
	public void SetSpecularGreen(float sg){
		foreach(Material m in BRDFMaterials){
			m.SetFloat("_sg",sg);
		}	
	}
	
	public void SetSpecularBlue(float sb){
		foreach(Material m in BRDFMaterials){
			m.SetFloat("_sb",sb);
		}	
	}
	
	public void SetDiffuseScale(float d){
		Color difcolor = d*Color.white;//new Color(d,d,d,1.0f);
		foreach(Material m in BRDFMaterials){
			m.SetColor("_Color",difcolor);
		}
		
	}
	
	public void SetFresnelF0(float f){
		foreach(Material m in BRDFMaterials){
			m.SetFloat("_FresnelEta",f);
			
		}
	}
	
	public void SetSMS(float t){
		foreach(Material m in BRDFMaterials){
			m.SetFloat("_use_SMS",t);
		}
		maybeFit();
	}
	
	public void SetMSVG(float t){
		foreach(Material m in BRDFMaterials){
			m.SetFloat("_use_MSVG",t);	
		}
		maybeFit();
	}
	
	public void SetGGXVG(float t){
		foreach(Material m in BRDFMaterials){
			m.SetFloat("_GGXVG",t);	
		}
		maybeFit();
	}
	
	public void SetHeitz(float t){
		foreach(Material m in BRDFMaterials){
			m.SetFloat("_Heitz",t);	
		}
		maybeFit();
	}
	
	public void SetShowInfoShader(float t){
		foreach(Material m in BRDFMaterials){
			m.SetFloat("_show_info_shader",t);	
		}
	}
	
	public void setActive(int index){
		activeindex = index;
		for(int i = 0; i < numobj; i++){
			objects[i].SetActive(false);
		}
		if(index>=0){
		objects[index].SetActive(true);
		activeobj = objects[index];
		topChangeMaterial(activeobj, BRDFMaterials[activeBRDFnumber]);
		}
	}
	
	public void setAutoFit(bool b){
		autoFit = b;
	}
	
	public void maybeFit(){
		if(autoFit) pickFit();
		else{ApplyFitButton.applyChange();}
	}
	
	public void updateMatCanvasSliders(){
		drslider.value = (float)BRDFMaterials[activeBRDFnumber].GetFloat("_dr");
		dgslider.value = (float)BRDFMaterials[activeBRDFnumber].GetFloat("_dg");
		dbslider.value = (float)BRDFMaterials[activeBRDFnumber].GetFloat("_db");
		srslider.value = (float)BRDFMaterials[activeBRDFnumber].GetFloat("_sr");
		sgslider.value = (float)BRDFMaterials[activeBRDFnumber].GetFloat("_sg");
		sbslider.value = (float)BRDFMaterials[activeBRDFnumber].GetFloat("_sb");
		aslider.value = (float)BRDFMaterials[activeBRDFnumber].GetFloat("_RoughnessAlpha");
		etaslider.value = (float)BRDFMaterials[activeBRDFnumber].GetFloat("_FresnelEta");
	}
	
	public void updateMatCanvas(){
		updateMatCanvasSliders();
		if(activeBRDFnumber==2){
			int activeMS=0;
			if(BRDFMaterials[activeBRDFnumber].GetFloat("_Heitz")==1){
				activeMS=4;
			}
			if(BRDFMaterials[activeBRDFnumber].GetFloat("_use_SMS")==1){
				activeMS=1;
			}
			if(BRDFMaterials[activeBRDFnumber].GetFloat("_use_MSVG")==1){
				activeMS=3;
			}
			if(BRDFMaterials[activeBRDFnumber].GetFloat("_GGXVG")==1){
				activeMS+=2;
			}
			int m = activeMS;
			switch(m){
				case 0:
					MSButtons.selectButton(0);
					break;
				case 1:
					MSButtons.selectButton(1);
					break;
				case 2:
					MSButtons.selectButton(4);
					break;
				case 3:
					MSButtons.selectButton(2);
					break;
				case 4:
					MSButtons.selectButton(5);//This can not happen, maybe someday it can be Heitz
					break;
				case 5:
					MSButtons.selectButton(3);
					break;
			}
		}
			if(activeindex==-1){GeoButtons.selectButton(3);}
			if(activeindex==0){GeoButtons.selectButton(0);}
			if(activeindex==1){GeoButtons.selectButton(1);}
			if(activeindex==2){GeoButtons.selectButton(2);}
		if(autoFit){autoFitButtons.selectButton(0);}
		else{autoFitButtons.selectButton(1);}
		
		if(activeBRDFnumber>0){MERLButtons.selectButton(1);}
		else{MERLButtons.selectButton(0);}
		
		if(activeBRDFnumber==1){ModelsButtons.selectButton(1);}
		if(activeBRDFnumber==2){ModelsButtons.selectButton(0);}
		if(activeBRDFnumber==3){ModelsButtons.selectButton(2);}
		
		showOrHideMSText();
	}
	
	
	public void pickFit(){
		if(activeBRDFnumber==0) return;
		if(activeBRDFnumber==1) setFit(1);
		if(activeBRDFnumber==2) {
			int activeMS=0;
			if(BRDFMaterials[activeBRDFnumber].GetFloat("_use_SMS")==1){
				activeMS=1;
			}
			if(BRDFMaterials[activeBRDFnumber].GetFloat("_use_MSVG")==1){
				activeMS=3;
			}
			if(BRDFMaterials[activeBRDFnumber].GetFloat("_GGXVG")==1){
				activeMS=2;
			}
			if(BRDFMaterials[activeBRDFnumber].GetFloat("_Heitz")==1){
				activeMS=4;
			}
			setFit(2+activeMS);
		}
		ApplyFitButton.buttonPressed();
	}
	
	public void setFit(int model){
		switch (model){
			case 0:
				break;
			case 1:
				setCTfit();
				break;
			case 2:
				setGGXfit();
				break;
			case 3:
				setGGXVGfit();
				break;
			case 4:
				setGGXSMSfit();
				break;
			case 5:
				setMSVGfit();
				break;
			case 6:
				setHeitzfit();
				break;
		}
	}
	
	public void setGGXfit(){
		//Set BRDF values
		SetDiffuseRed((float)GGXfits[mi,0]);
		SetDiffuseGreen((float)GGXfits[mi,1]);
		SetDiffuseBlue((float)GGXfits[mi,2]);
		SetSpecularRed((float)GGXfits[mi,3]);
		SetSpecularGreen((float)GGXfits[mi,4]);
		SetSpecularBlue((float)GGXfits[mi,5]);
		SetRoughness((float)GGXfits[mi,6]);
		SetFresnelF0(1.0f+(float)GGXfits[mi,7]*4.0f);
		//Set Sliders
		updateMatCanvasSliders();
	}
	
	public void setCTfit(){
		//Set BRDF values
		SetDiffuseRed((float)CTfits[mi,0]);
		SetDiffuseGreen((float)CTfits[mi,1]);
		SetDiffuseBlue((float)CTfits[mi,2]);
		SetSpecularRed((float)CTfits[mi,3]);
		SetSpecularGreen((float)CTfits[mi,4]);
		SetSpecularBlue((float)CTfits[mi,5]);
		SetRoughness((float)CTfits[mi,6]);
		SetFresnelF0(1.0f+(float)CTfits[mi,7]*4.0f);
		//Set Sliders
		updateMatCanvasSliders();
	}
	
	public void setGGXVGfit(){
		//Set BRDF values
		SetDiffuseRed((float)GGXVGfits[mi,0]);
		SetDiffuseGreen((float)GGXVGfits[mi,1]);
		SetDiffuseBlue((float)GGXVGfits[mi,2]);
		SetSpecularRed((float)GGXVGfits[mi,3]);
		SetSpecularGreen((float)GGXVGfits[mi,4]);
		SetSpecularBlue((float)GGXVGfits[mi,5]);
		SetRoughness((float)GGXVGfits[mi,6]);
		SetFresnelF0(1.0f+(float)GGXVGfits[mi,7]*4.0f);
		//Set Sliders
		updateMatCanvasSliders();
	}
	
	public void setGGXSMSfit(){
		//Set BRDF values
		SetDiffuseRed((float)GGXSMSfits[mi,0]);
		SetDiffuseGreen((float)GGXSMSfits[mi,1]);
		SetDiffuseBlue((float)GGXSMSfits[mi,2]);
		SetSpecularRed((float)GGXSMSfits[mi,3]);
		SetSpecularGreen((float)GGXSMSfits[mi,4]);
		SetSpecularBlue((float)GGXSMSfits[mi,5]);
		SetRoughness((float)GGXSMSfits[mi,6]);
		SetFresnelF0(1.0f+(float)GGXSMSfits[mi,7]*4.0f);
		//Set Sliders
		updateMatCanvasSliders();
	}
	
	public void setMSVGfit(){
		//Set BRDF values
		SetDiffuseRed((float)MSVGfits[mi,0]);
		SetDiffuseGreen((float)MSVGfits[mi,1]);
		SetDiffuseBlue((float)MSVGfits[mi,2]);
		SetSpecularRed((float)MSVGfits[mi,3]);
		SetSpecularGreen((float)MSVGfits[mi,4]);
		SetSpecularBlue((float)MSVGfits[mi,5]);
		SetRoughness((float)MSVGfits[mi,6]);
		SetFresnelF0(1.0f+(float)MSVGfits[mi,7]*4.0f);
		//Set Sliders
		updateMatCanvasSliders();
	}
	
	public void setHeitzfit(){
		//Set BRDF values
		SetDiffuseRed((float)Heitzfits[mi,0]);
		SetDiffuseGreen((float)Heitzfits[mi,1]);
		SetDiffuseBlue((float)Heitzfits[mi,2]);
		SetSpecularRed((float)Heitzfits[mi,3]);
		SetSpecularGreen((float)Heitzfits[mi,4]);
		SetSpecularBlue((float)Heitzfits[mi,5]);
		SetRoughness((float)Heitzfits[mi,6]);
		SetFresnelF0(1.0f+(float)Heitzfits[mi,7]*4.0f);
		//Set Sliders
		updateMatCanvasSliders();
	}
	
	public void SetInterpMERL(float f){
		foreach(Material m in MERLMaterials){
			m.SetFloat("_InterpMERL",f);
		}
	}
	
	public void SetFloatMERL(float f){
		foreach(Material m in MERLMaterials){
			m.SetFloat("_FloatMERL",f);
		}
	}
	
	public void SaveSlotX(string prefix){
		//save slider parameters
		float dr = (float)BRDFMaterials[activeBRDFnumber].GetFloat("_dr");
		float dg = (float)BRDFMaterials[activeBRDFnumber].GetFloat("_dg");
		float db = (float)BRDFMaterials[activeBRDFnumber].GetFloat("_db");
		float sr = (float)BRDFMaterials[activeBRDFnumber].GetFloat("_sr");
		float sg = (float)BRDFMaterials[activeBRDFnumber].GetFloat("_sg");
		float sb = (float)BRDFMaterials[activeBRDFnumber].GetFloat("_sb");
		float alpha = (float)BRDFMaterials[activeBRDFnumber].GetFloat("_RoughnessAlpha");
		float fresnel = (float)BRDFMaterials[activeBRDFnumber].GetFloat("_FresnelEta");
		
		PlayerPrefs.SetFloat(prefix+"_dr", dr);
		PlayerPrefs.SetFloat(prefix+"_dg", dg);
		PlayerPrefs.SetFloat(prefix+"_db", db);
		PlayerPrefs.SetFloat(prefix+"_sr", sr);
		PlayerPrefs.SetFloat(prefix+"_sg", sg);
		PlayerPrefs.SetFloat(prefix+"_sb", sb);
		PlayerPrefs.SetFloat(prefix+"_alpha", alpha);
		PlayerPrefs.SetFloat(prefix+"_fresnel", fresnel);
		
		//save model settings
		
		if(activeBRDFnumber==2){
			int activeMS=0;
			if(BRDFMaterials[activeBRDFnumber].GetFloat("_Heitz")==1){
				activeMS=4;
			}
			if(BRDFMaterials[activeBRDFnumber].GetFloat("_use_SMS")==1){
				activeMS=1;
			}
			if(BRDFMaterials[activeBRDFnumber].GetFloat("_use_MSVG")==1){
				activeMS=3;
			}
			if(BRDFMaterials[activeBRDFnumber].GetFloat("_GGXVG")==1){
				activeMS+=2;
			}
			int m = activeMS;
			switch(m){
				case 0:
					PlayerPrefs.SetInt(prefix+"_MS", 0);
					break;
				case 1:
					PlayerPrefs.SetInt(prefix+"_MS", 1);
					break;
				case 2:
					PlayerPrefs.SetInt(prefix+"_MS", 2);
					break;
				case 3:
					PlayerPrefs.SetInt(prefix+"_MS", 3);
					break;
				case 4:
					PlayerPrefs.SetInt(prefix+"_MS", 4);//This can not happen, maybe someday it can be Heitz
					break;
				case 5:
					PlayerPrefs.SetInt(prefix+"_MS", 5);
					break;
			}
		}
		
		PlayerPrefs.SetInt(prefix+"_BRDF", activeBRDFnumber);
		
	}
	
	public void SaveSlotA(){
		SaveSlotX("A");
		return;
	}
	
	public void SaveSlotB(){
		SaveSlotX("B");
		return;
	}
	
	public void SaveSlotC(){
		SaveSlotX("C");
		return;
	}
	
	private void LoadSlotX(string prefix){
		setAutoFit(false);
		
		changeBRDF(PlayerPrefs.GetInt(prefix+"_BRDF",0));
		
		switch(PlayerPrefs.GetInt(prefix+"_MS",-1)){
			case -1:
				break;
			case 0:
				SetGGXVG(0);
				SetSMS(0);
				SetMSVG(0);
				SetHeitz(0);
				break;
			case 1:
				SetGGXVG(0);
				SetSMS(1);
				SetMSVG(0);
				SetHeitz(0);
				break;
			case 2:
				SetGGXVG(1);
				SetSMS(0);
				SetMSVG(0);
				SetHeitz(0);
				break;
			case 3:
				SetGGXVG(0);
				SetSMS(0);
				SetMSVG(1);
				SetHeitz(0);
				break;
			case 4:
				SetGGXVG(0);
				SetSMS(0);
				SetMSVG(0);
				SetHeitz(1);
				break;
			case 5:
				SetGGXVG(1);
				SetSMS(0);
				SetMSVG(1);
				SetHeitz(0);
				break;
		}
		
		
		SetDiffuseRed(PlayerPrefs.GetFloat(prefix+"_dr",0));
		SetDiffuseGreen(PlayerPrefs.GetFloat(prefix+"_dg",0));
		SetDiffuseBlue(PlayerPrefs.GetFloat(prefix+"_db",0));
		SetSpecularRed(PlayerPrefs.GetFloat(prefix+"_sr",0));
		SetSpecularGreen(PlayerPrefs.GetFloat(prefix+"_sg",0));
		SetSpecularBlue(PlayerPrefs.GetFloat(prefix+"_sb",0));
		SetRoughness(PlayerPrefs.GetFloat(prefix+"_alpha",0.5f));
		SetFresnelF0(PlayerPrefs.GetFloat(prefix+"_fresnel",0));
		//Set Sliders
		updateMatCanvas();
		
	}
	
	public void LoadSlotA(){
		LoadSlotX("A");
		return;
	}
	
	public void LoadSlotB(){
		LoadSlotX("B");
		return;
	}
	
	public void LoadSlotC(){
		LoadSlotX("C");
		return;
	}
	
	
	// Start is called before the first frame update
    void Start()
    {	
		activeindex = 0;
        activeobj = objects[activeindex];
		setActive(-1);
		changeMERLMaterial(0);
		updateStrings();
		setGGXfit();
		autoFit = true;
    }
	

    // Update is called once per frame
    void Update()
    {
		if(countdown>0){
			countdown=countdown-1;
		}
		//updateStrings();
        BRDFMaterials[activeBRDFnumber].SetMatrix("_rotmat",Matrix4x4.Rotate(Quaternion.Inverse(GetComponent<Transform>().rotation)));
    }
}
